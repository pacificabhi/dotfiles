# Sway configuration (migrated from Hyprland)
# Reference: https://man.archlinux.org/man/sway.5

###################
### MY PROGRAMS ###
###################

set $terminal kitty
set $fileManager dolphin
set $chrome google-chrome-stable
set $firefox firefox
set $menu wofi --show drun --allow-images
set $shots_dir ~/Pictures/Screenshots

#############################
### ENVIRONMENT VARIABLES ###
#############################

# NVIDIA-specific environment variables (CRITICAL for NVIDIA GPUs)
exec systemctl --user import-environment DISPLAY WAYLAND_DISPLAY SWAYSOCK XDG_CURRENT_DESKTOP
exec hash dbus-update-activation-environment 2>/dev/null && \
     dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY SWAYSOCK XDG_CURRENT_DESKTOP

# Cursor configuration
seat * xcursor_theme default 24

################
### MONITORS ###
################

# Monitor 1 (Left / Primary) - 1920x1080@60Hz
output "BNQ BenQ GW2780 ET58P0107604U" resolution 1920x1080@60Hz position 0,0

# Monitor 2 (Right / Secondary) - 2560x1440@75Hz
output "BNQ BenQ GW2790QT XBR00903019" resolution 2560x1440@75Hz position 1920,0

# Bind workspaces to monitors
workspace 1 output "BNQ BenQ GW2780 ET58P0107604U"
workspace 2 output "BNQ BenQ GW2780 ET58P0107604U"
workspace 3 output "BNQ BenQ GW2780 ET58P0107604U"
workspace 4 output "BNQ BenQ GW2780 ET58P0107604U"
workspace 5 output "BNQ BenQ GW2780 ET58P0107604U"

workspace 6 output "BNQ BenQ GW2790QT XBR00903019"
workspace 7 output "BNQ BenQ GW2790QT XBR00903019"
workspace 8 output "BNQ BenQ GW2790QT XBR00903019"
workspace 9 output "BNQ BenQ GW2790QT XBR00903019"
workspace 10 output "BNQ BenQ GW2790QT XBR00903019"

#####################
### LOOK AND FEEL ###
#####################

# Gaps and borders
gaps inner 1
gaps outer 2
default_border pixel 1

# Colors (matching Hyprland theme)
# class                 border  backgr. text    indicator child_border
client.focused          #787878 #787878 #ffffff #787878   #787878
client.focused_inactive #595959 #595959 #ffffff #595959   #595959
client.unfocused        #595959 #595959 #888888 #595959   #595959
client.urgent           #ff0000 #ff0000 #ffffff #ff0000   #ff0000

# Window configuration
focus_follows_mouse yes
mouse_warping output

# Layout
workspace_layout default

#############
### INPUT ###
#############

# Keyboard
input type:keyboard {
    xkb_layout us
    repeat_delay 300
    repeat_rate 50
}

# Mouse/Touchpad
input type:pointer {
    accel_profile flat
}

input type:touchpad {
    tap enabled
    natural_scroll disabled
}

#################
### AUTOSTART ###
#################

exec $terminal
exec nm-applet
exec swaybg -i ~/.config/hypr/wallpapers/* -m fill  # Using swaybg instead of hyprpaper
exec mako
exec swayidle -w \
    timeout 300 'swaylock -f' \
    timeout 600 'swaymsg "output * dpms off"' \
    resume 'swaymsg "output * dpms on"' \
    before-sleep 'swaylock -f'
exec mkdir -p $shots_dir
exec /usr/lib/pam_kwallet_init
exec ~/.config/hypr/scripts/kwallet-start.sh

# Set default workspaces
exec swaymsg 'workspace 1; workspace 10'

###################
### KEYBINDINGS ###
###################

# Modifier key (Super/Windows key)
set $mod Mod4

# Basic bindings
bindsym $mod+Return exec $terminal
bindsym $mod+c kill
bindsym $mod+m exec swaymsg exit
bindsym $mod+e exec $fileManager
bindsym $mod+v floating toggle
bindsym $mod+space exec $menu
bindsym $mod+p fullscreen toggle
bindsym $mod+j split toggle
bindsym $mod+l exec swaylock

# Custom hotkeys
bindsym $mod+w exec $firefox
bindsym $mod+Shift+w exec $chrome

# Focus movement
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# Window movement
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# Workspace switching
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# Move windows to workspaces
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

# Scratchpad (special workspace)
bindsym $mod+s scratchpad show
bindsym $mod+Shift+s move scratchpad

# Window resizing (resize mode)
mode "resize" {
    bindsym Left resize shrink width 10px
    bindsym Down resize grow height 10px
    bindsym Up resize shrink height 10px
    bindsym Right resize grow width 10px

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+r mode "resize"

# Alternative: Direct resize with Shift+arrows (matching Hyprland)
bindsym $mod+Shift+Ctrl+Left resize shrink width 10px
bindsym $mod+Shift+Ctrl+Down resize grow height 10px
bindsym $mod+Shift+Ctrl+Up resize shrink height 10px
bindsym $mod+Shift+Ctrl+Right resize grow width 10px

# Mouse bindings
floating_modifier $mod normal

# Multimedia keys
bindsym XF86AudioRaiseVolume exec wpctl set-volume -l 1 @DEFAULT_AUDIO_SINK@ 5%+
bindsym XF86AudioLowerVolume exec wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindsym XF86AudioMute exec wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindsym XF86AudioMicMute exec wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
bindsym XF86MonBrightnessUp exec brightnessctl -e4 -n2 set 5%+
bindsym XF86MonBrightnessDown exec brightnessctl -e4 -n2 set 5%-

# Media controls (requires playerctl)
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPause exec playerctl play-pause
bindsym XF86AudioPlay exec playerctl play-pause
bindsym XF86AudioPrev exec playerctl previous

# Screenshots (using grim + slurp)
# Active window screenshot
bindsym Ctrl+Alt+p exec grim -g "$(swaymsg -t get_tree | jq -r '.. | select(.focused?) | .rect | "\(.x),\(.y) \(.width)x\(.height)"')" $shots_dir/window-$(date +'%Y%m%d-%H%M%S').png && notify-send "Screenshot saved" "Window screenshot saved"

# Area selection screenshot
bindsym Ctrl+Alt+Shift+p exec grim -g "$(slurp)" $shots_dir/area-$(date +'%Y%m%d-%H%M%S').png && notify-send "Screenshot saved" "Area screenshot saved"

# Full screen screenshot
bindsym Ctrl+Alt+$mod+p exec grim $shots_dir/full-$(date +'%Y%m%d-%H%M%S').png && notify-send "Screenshot saved" "Full screenshot saved"

##############################
### WINDOWS AND WORKSPACES ###
##############################

# Floating windows
for_window [app_id=".*"] border pixel 1

# XWayland fixes
for_window [shell="xwayland"] title_format "[XWayland] %title"

# Status bar
bar {
    swaybar_command waybar
}
